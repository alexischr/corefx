parameters:
  HelixSource: 'pr/dotnet-github-anon-kaonashi-bot'
  HelixType: Ì“'tests/default'
  HelixBuild: $(Build.BuildNumber)
  HelixTargetQueues: ''
  HelixAccessToken: ''
  HelixPreCommands: ''
  HelixPostCommands: ''
  WorkItemDirectory: ''
  WorkItemArchiveWildCard: ''
  WorkItemCommand: ''
  HelixCorrelationPayload: ''
  IncludeDotNetCli: false
  DotNetCliPackageType: ''
  DotNetCliVersion: ''
  EnableXUnitReporter: false
  WaitForWorkItemCompletion: true
  condition: succeeded()
  continueOnError: false

  - template: /eng/common/steps/run-on-unix.yml
    parameters:
      agentOs: $(Agent.OS)
      steps:
        - script: ./eng/common/msbuild.sh
                  eng/common/helixpublish.proj /t:test
        displayName: Send job to Helix Linux
        condition: ${{ parameters.condition }}
        continueOnError: ${{ parameters.continueOnError }}
        env:
          HelixSource: ${{ parameters.HelixSource }}
          HelixType: ${{ parameters.HelixType }}
          HelixBuild: ${{ parameters.HelixBuild }}
          HelixTargetQueues: ${{ parameters.HelixTargetQueues }}
          HelixAccessToken: ${{ parameters.HelixAccessToken }}
          HelixPreCommands: ${{ parameters.HelixPreCommands }}
          HelixPostCommands: ${{ parameters.HelixPostCommands }}
          HelixCorrelationPayload: ${{ parameters.HelixCorrelationPayload }}
          WorkItemDirectory: ${{ parameters.WorkItemDirectory }}
          WorkItemCommand: ${{ parameters.WorkItemCommand }}
          IncludeDotNetCli: ${{ parameters.IncludeDotNetCli }}
          DotNetCliPackageType: ${{ parameters.DotNetCliPackageType }}
          DotNetCliVersion: ${{ parameters.DotNetCliVersion }}
          EnableXUnitReporter: ${{ parameters.EnableXUnitReporter }}
          WaitForWorkItemCompletion: ${{ parameters.WaitForWorkItemCompletion }}
          WorkItemArchiveWildCard: ${{ parameters.WorkItemArchiveWildCard }}
    - template: /eng/common/steps/run-on-windows.yml
      parameters:
        agentOs: $(Agent.OS)
        steps:
          - powershell: & \"$(Build.SourcesDirectory)\eng\common\msbuild.ps1\" eng/common/helixpublish.proj /t:test
            displayName: Send job to Helix Windows
            condition: ${{ parameters.condition }}
            continueOnError: ${{ parameters.continueOnError }}
            env:
              HelixSource: ${{ parameters.HelixSource }}
              HelixType: ${{ parameters.HelixType }}
              HelixBuild: ${{ parameters.HelixBuild }}
              HelixTargetQueues: ${{ parameters.HelixTargetQueues }}
              HelixAccessToken: ${{ parameters.HelixAccessToken }}
              HelixPreCommands: ${{ parameters.HelixPreCommands }}
              HelixPostCommands: ${{ parameters.HelixPostCommands }}
              HelixCorrelationPayload: ${{ parameters.HelixCorrelationPayload }}
              WorkItemDirectory: ${{ parameters.WorkItemDirectory }}
              WorkItemCommand: ${{ parameters.WorkItemCommand }}
              IncludeDotNetCli: ${{ parameters.IncludeDotNetCli }}
              DotNetCliPackageType: ${{ parameters.DotNetCliPackageType }}
              DotNetCliVersion: ${{ parameters.DotNetCliVersion }}
              EnableXUnitReporter: ${{ parameters.EnableXUnitReporter }}
              WaitForWorkItemCompletion: ${{ parameters.WaitForWorkItemCompletion }}
              WorkItemArchiveWildCard: ${{ parameters.WorkItemArchiveWildCard }}
